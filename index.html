<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Japanese Vocabulary Cards</title>
    <link rel="stylesheet" href="styles.css?v=1.4.9">
    <script src="script.js?v=1.4.9"></script>
</head>
<body>
    <div class="app-layout">
        <!-- Top Controls -->
        <div class="top-site-controls" style="position: absolute; top: 10px; left: 10px; z-index: 1000;">
            <button class="show-words-button" id="showWordsBtn" data-translate="show-all-words">ğŸ“– Show All Words</button>
        </div>
        
        <!-- Stats Sidebar -->
        <div class="stats-sidebar">
            <div class="stats-header" data-translate="statistics">Statistics</div>
            
            <div class="stats-list" id="statsList">
                <!-- Statistics will be populated dynamically by JavaScript -->
            </div>
            
            <button class="download-stats-button" id="downloadStatsBtn" data-translate="download-stats">ğŸ“¥ Download Statistics</button>
        </div>

        <div class="container">
            <div class="language-toggle" style="text-align: right;">
                <button class="language-button" id="languageToggle">ğŸ‡ºğŸ‡¸ EN</button>
                <button class="reset-button" id="resetBtn" data-translate="reset">ğŸ”„ Reset</button>
                <button class="flip-direction-button" id="flipDirectionBtn">ğŸ‡ºğŸ‡¸ â†’ ğŸ‡¯ğŸ‡µ</button>
            </div>
        
            <div class="header">
                <h1 data-translate="title">ğŸŒ Japanese Vocabulary Cards</h1>
                <p data-translate="subtitle">Learn Japanese vocabulary with interactive flashcards</p>
            </div>

            <div class="card-container">
                <div class="card-status-marker" id="cardStatusMarker">GUESSING</div>
                <div class="card" id="flashcard">
                    <div class="card-front">
                        <div class="category" id="category">general</div>
                        <div class="romaji" id="romaji">Loading...</div>
                        <div class="hiragana" id="hiragana">èª­ã¿è¾¼ã¿ä¸­...</div>
                    </div>
                    <div class="card-back">
                        <div class="english" id="english">Loading...</div>
                    </div>
                </div>
                <div class="card-hint" data-translate="click-to-flip">Click to flip</div>
            </div>

            <div class="controls">
                <button class="btn btn-secondary" id="prevBtn" data-translate="previous">â† Previous</button>
                <button class="btn btn-primary" id="flipBtn" data-translate="flip-card">Flip Card</button>
                <button class="btn btn-secondary" id="nextBtn" data-translate="next">Next â†’</button>
            </div>

            <div class="controls" style="margin-top: 15px;">
                <button class="btn btn-success" id="shuffleBtn" data-translate="shuffle">ğŸ”€ Shuffle</button>
            </div>

            <div class="controls" style="margin-top: 15px;">
                <button class="btn btn-correct" id="correctBtn" data-translate="correct">âœ“ Correct</button>
                <button class="btn btn-incorrect" id="incorrectBtn" data-translate="incorrect">âœ— Incorrect</button>
            </div>

            <div class="progress">
                <div><span data-translate="card">Card</span> <span id="currentCard">1</span> <span data-translate="of">of</span> <span id="totalCards">12</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>

        <!-- Category Sidebar -->
        <div class="category-sidebar">
            <div class="category-header" data-translate="categories">Categories</div>
            
            <div class="category-controls">
                <button class="btn-category btn-all" id="selectAllBtn" data-translate="select-all">All</button>
                <button class="btn-category btn-none" id="selectNoneBtn" data-translate="select-none">None</button>
            </div>
            
            <div class="category-list" id="categoryList">
                <!-- Categories will be populated dynamically by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Words Modal -->
    <div class="words-modal" id="wordsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-translate="all-words-title">All Vocabulary Words</h2>
                <div class="word-count-display">
                    <span id="wordCount" data-translate="word-count">0 words</span>
                </div>
                <div class="modal-header-buttons">
                    <button class="download-words-button" id="downloadWordsBtn" data-translate="download-words">ğŸ“¥ Download Vocabulary</button>
                    <button class="close-modal" id="closeModalBtn">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="table-controls">
                    <div class="filter-section">
                        <label for="categoryFilter" data-translate="filter-by-category">Filter by Category:</label>
                        <select id="categoryFilter" class="filter-select">
                            <option value="" data-translate="all-categories">All Categories</option>
                        </select>
                    </div>
                    <div class="search-section">
                        <label for="searchInput" data-translate="search-words">Search Words:</label>
                        <input type="text" id="searchInput" class="search-input" placeholder="Type to search..." data-translate-placeholder="search-placeholder">
                    </div>
                    <div class="sort-section">
                        <label data-translate="sort-by">Sort by:</label>
                        <button class="sort-btn" data-column="romaji" data-translate="sort-romaji">Romaji â†•</button>
                        <button class="sort-btn" data-column="hiragana" data-translate="sort-japanese">Japanese â†•</button>
                        <button class="sort-btn" data-column="english" data-translate="sort-english">English â†•</button>
                        <button class="sort-btn" data-column="spanish" data-translate="sort-spanish">Spanish â†•</button>
                        <button class="sort-btn" data-column="category" data-translate="sort-category">Category â†•</button>
                    </div>
                </div>
                <div class="words-table-container">
                    <table class="words-table" id="wordsTable">
                        <thead>
                            <tr>
                                <th data-translate="romaji-header">Romaji</th>
                                <th data-translate="japanese-header">Japanese</th>
                                <th data-translate="english-header">English</th>
                                <th data-translate="spanish-header">Spanish</th>
                                <th data-translate="category-header">Category</th>
                            </tr>
                        </thead>
                        <tbody id="wordsTableBody">
                            <!-- Words will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js?v=1.4.9"></script>
    <script>
        // Development auto-reload functionality
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
            let lastModified = null;
            
            async function checkForUpdates() {
                try {
                    const response = await fetch('/api/last-modified');
                    const data = await response.json();
                    
                    if (lastModified && data.lastModified !== lastModified) {
                        console.log('ğŸ”„ Files changed, reloading page...');
                        location.reload();
                    }
                    
                    lastModified = data.lastModified;
                } catch (error) {
                    // Silently handle errors in production
                }
            }
            
            // Check for updates every 1000ms
            setInterval(checkForUpdates, 1000);
            checkForUpdates();
        }
    </script>
</body>
</html>
